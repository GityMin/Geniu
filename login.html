<!DOCTYPE html>
<html lang="ru">
<head>
    <title>–í—Ö–æ–¥/–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è | –î–µ–Ω–∏—Å –ö–∞–∑–∞–∫–æ–≤</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        /* –ì–õ–û–ë–ê–õ–¨–ù–´–ï –°–¢–ò–õ–ò */
        body { 
            font-family: 'Arial', sans-serif; 
            background-color: #121212; 
            color: #E0E0E0; 
            text-align: center; 
            padding-top: 50px; 
        }
        .nav-bar { 
            background-color: #333; 
            padding: 10px 0; 
            margin-bottom: 50px; 
        }
        .nav-bar a { 
            color: #fff; 
            padding: 14px 20px; 
            text-decoration: none; 
            font-size: 18px; 
            font-weight: bold; 
        }
        .nav-bar a:hover { 
            background-color: #575757; 
        }
        h1 { 
            color: #FFFF00; 
            text-shadow: 0 0 10px #FFFF00; 
        }

        /* –ö–û–ù–¢–ï–ô–ù–ï–† –§–û–†–ú–´ */
        .auth-container {
            max-width: 400px;
            margin: 0 auto;
            background-color: #1E1E1E;
            padding: 30px;
            border-radius: 10px;
            border: 2px solid #FFFF00;
            box-shadow: 0 0 20px rgba(255, 255, 0, 0.4);
            text-align: left;
        }

        /* –≠–ª–µ–º–µ–Ω—Ç—ã —Ñ–æ—Ä–º—ã */
        .auth-container label {
            display: block;
            margin-top: 15px;
            font-weight: bold;
            color: #E0E0E0;
        }
        .auth-container input {
            width: 100%;
            padding: 10px;
            margin-top: 5px;
            border: 1px solid #555;
            border-radius: 5px;
            background-color: #282828;
            color: white;
            box-sizing: border-box; 
            font-size: 1.1em;
        }
        .auth-container button {
            width: 100%;
            padding: 12px;
            margin-top: 25px;
            font-size: 1.2em;
            cursor: pointer;
            border: none;
            border-radius: 5px;
            background-color: #FF8C00; 
            color: black;
            font-weight: bold;
            transition: background-color 0.2s;
        }
        .auth-container button:hover {
            background-color: #FFA500;
        }

        /* –°–æ–æ–±—â–µ–Ω–∏–µ */
        #message {
            margin-top: 20px;
            font-size: 1.1em;
            color: #00FF00; /* –ó–µ–ª–µ–Ω—ã–π –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é */
        }

        /* –†–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å –∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ */
        .switch-mode {
            text-align: center;
            margin-top: 20px;
            padding-top: 15px;
            border-top: 1px solid #444;
        }
        .switch-mode button {
            background: none;
            border: none;
            color: #00FFFF;
            cursor: pointer;
            font-size: 1em;
            padding: 5px;
            width: auto;
            margin: 0;
            text-decoration: underline;
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –í—ã—Ö–æ–¥–∞ */
        .logout-panel {
            max-width: 400px;
            margin: 0 auto;
            background-color: #1E1E1E;
            padding: 30px;
            border-radius: 10px;
            border: 2px solid #00FFFF;
            box-shadow: 0 0 20px rgba(0, 255, 255, 0.4);
            text-align: center;
        }
        .logout-panel button {
            background-color: #FF0000;
            color: white;
        }
        .logout-panel button:hover {
            background-color: #CC0000;
        }
        #current-user {
            font-size: 1.5em;
            color: #00FF00;
            margin-bottom: 20px;
        }
        
        /* –ú–û–ë–ò–õ–¨–ù–ê–Ø –ê–î–ê–ü–¢–ê–¶–ò–Ø */
        @media (max-width: 500px) {
            .auth-container, .logout-panel {
                margin: 0 10px;
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="nav-bar">
        <a href="index.html">–ì–ª–∞–≤–Ω–∞—è</a>
        <a href="games.html">–ò–≥—Ä—ã</a>
        <a href="about.html">–ê–≤—Ç–æ—Ä</a>
        <a href="login.html">–í—Ö–æ–¥/–í—ã—Ö–æ–¥</a>
    </div>

    <h1>üë§ –°–∏—Å—Ç–µ–º–∞ –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –ì–µ–Ω–∏—è </h1>

    <div class="logout-panel" id="logout-view" style="display: none;">
        <h2>–¢—ã –≤–æ—à–µ–ª, –ì–µ–Ω–∏–π!</h2>
        <p id="current-user"></p>
        <button id="logout-button">–í—ã–π—Ç–∏</button>
        <p id="money-info" style="margin-top: 15px; font-weight: bold;"></p>
    </div>

    <div class="auth-container" id="auth-view">
        <h2 id="form-title">–í–æ–π—Ç–∏</h2>
        
        <form id="auth-form">
            <label for="username">–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:</label>
            <input type="text" id="username" required>
            
            <label for="password">–ü–∞—Ä–æ–ª—å:</label>
            <input type="password" id="password" required>
            
            <button type="submit" id="auth-button">–í–æ–π—Ç–∏</button>
        </form>

        <p id="message"></p>

        <div class="switch-mode">
            <p id="switch-text">–ù–µ—Ç –∞–∫–∫–∞—É–Ω—Ç–∞? 
                <button id="switch-button">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</button>
            </p>
        </div>
    </div>

    <script>
        window.onload = function() {
            const AUTH_VIEW = document.getElementById('auth-view');
            const LOGOUT_VIEW = document.getElementById('logout-view');
            const FORM_TITLE = document.getElementById('form-title');
            const AUTH_FORM = document.getElementById('auth-form');
            const USERNAME_INPUT = document.getElementById('username');
            const PASSWORD_INPUT = document.getElementById('password');
            const AUTH_BUTTON = document.getElementById('auth-button');
            const MESSAGE = document.getElementById('message');
            const SWITCH_BUTTON = document.getElementById('switch-button');
            const SWITCH_TEXT = document.getElementById('switch-text');
            const LOGOUT_BUTTON = document.getElementById('logout-button');
            const CURRENT_USER = document.getElementById('current-user');
            const MONEY_INFO = document.getElementById('money-info');

            let isLoginMode = true; 
            const USERS_KEY = 'denisKazakovUsers'; 
            const CURRENT_USER_KEY = 'denisKazakovUser'; 
            
            // --- –§–£–ù–ö–¶–ò–ò –ë–ê–õ–ê–ù–°–ê –° –ü–†–ò–í–Ø–ó–ö–û–ô –ö –õ–û–ì–ò–ù–£ (–¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è) ---
            const SECRET_KEY = 952; 
            const MONEY_PREFIX = 'money_';
            const CHECKSUM_PREFIX = 'checksum_';

            function getMoneyKey(username) { return MONEY_PREFIX + username; }
            function getChecksumKey(username) { return CHECKSUM_PREFIX + username; }

            function getMoney(username) {
                const moneyKey = getMoneyKey(username);
                const checksumKey = getChecksumKey(username);

                const storedMoney = parseInt(localStorage.getItem(moneyKey));
                const storedChecksum = parseInt(localStorage.getItem(checksumKey));

                // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏
                if (storedMoney + SECRET_KEY !== storedChecksum) {
                    return '–ù–ï–î–ï–ô–°–¢–í–ò–¢–ï–õ–ï–ù (–≤–∑–ª–æ–º)';
                }
                return storedMoney;
            }

            // –°–æ–∑–¥–∞–Ω–∏–µ –Ω–∞—á–∞–ª—å–Ω–æ–≥–æ –±–∞–ª–∞–Ω—Å–∞ —Å –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω–æ–π —Å—É–º–º–æ–π
            function setInitialMoney(username) {
                const initialAmount = 100;
                const moneyKey = getMoneyKey(username);
                const checksumKey = getChecksumKey(username);
                
                const newChecksum = initialAmount + SECRET_KEY;
                
                localStorage.setItem(moneyKey, initialAmount);
                localStorage.setItem(checksumKey, newChecksum);
            }
            // --- –ö–û–ù–ï–¶ –§–£–ù–ö–¶–ò–ô –ë–ê–õ–ê–ù–°–ê ---
            
            function getUsers() {
                return JSON.parse(localStorage.getItem(USERS_KEY)) || {};
            }

            function saveUsers(users) {
                localStorage.setItem(USERS_KEY, JSON.stringify(users));
            }

            function switchMode() {
                isLoginMode = !isLoginMode;
                
                FORM_TITLE.textContent = isLoginMode ? '–í–æ–π—Ç–∏' : '–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è';
                AUTH_BUTTON.textContent = isLoginMode ? '–í–æ–π—Ç–∏' : '–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è';
                
                SWITCH_TEXT.innerHTML = isLoginMode 
                    ? `–ù–µ—Ç –∞–∫–∫–∞—É–Ω—Ç–∞? <button id="switch-button">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</button>`
                    : `–£–∂–µ –µ—Å—Ç—å –∞–∫–∫–∞—É–Ω—Ç? <button id="switch-button">–í–æ–π—Ç–∏</button>`;

                // –ü–µ—Ä–µ–Ω–∞–∑–Ω–∞—á–∞–µ–º —Å–ª—É—à–∞—Ç–µ–ª—å –Ω–∞ –Ω–æ–≤—É—é –∫–Ω–æ–ø–∫—É
                document.getElementById('switch-button').addEventListener('click', switchMode);

                MESSAGE.textContent = '';
                USERNAME_INPUT.value = '';
                PASSWORD_INPUT.value = '';
            }

            function handleAuth(e) {
                e.preventDefault();
                MESSAGE.textContent = ''; 
                
                const username = USERNAME_INPUT.value.trim();
                const password = PASSWORD_INPUT.value.trim();
                const users = getUsers();

                if (username.length < 3 || password.length < 3) {
                    MESSAGE.textContent = '–ò–º—è –∏ –ø–∞—Ä–æ–ª—å –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –Ω–µ –º–µ–Ω–µ–µ 3 —Å–∏–º–≤–æ–ª–æ–≤.';
                    MESSAGE.style.color = '#FFD700';
                    return;
                }
                
                if (isLoginMode) {
                    // --- –õ–û–ì–ò–ö–ê –í–•–û–î–ê ---
                    if (users[username] && users[username].password === password) {
                        localStorage.setItem(CURRENT_USER_KEY, username);
                        displayAuthState(username);
                        MESSAGE.textContent = `–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, ${username}!`;
                        MESSAGE.style.color = '#00FF00';
                    } else {
                        MESSAGE.textContent = '–ù–µ–≤–µ—Ä–Ω–æ–µ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–ª–∏ –ø–∞—Ä–æ–ª—å.';
                        MESSAGE.style.color = '#FF0000';
                    }
                } else {
                    // --- –õ–û–ì–ò–ö–ê –†–ï–ì–ò–°–¢–†–ê–¶–ò–ò ---
                    if (users[username]) {
                        MESSAGE.textContent = '–≠—Ç–æ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —É–∂–µ –∑–∞–Ω—è—Ç–æ.';
                        MESSAGE.style.color = '#FF0000';
                    } else {
                        users[username] = { password: password };
                        saveUsers(users);
                        setInitialMoney(username); // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–∞—á–∞–ª—å–Ω–æ–≥–æ –±–∞–ª–∞–Ω—Å–∞ (100)

                        localStorage.setItem(CURRENT_USER_KEY, username);
                        displayAuthState(username);
                        
                        MESSAGE.textContent = `‚úÖ –ê–∫–∫–∞—É–Ω—Ç ${username} —Å–æ–∑–¥–∞–Ω! –¢–µ–±–µ –Ω–∞—á–∏—Å–ª–µ–Ω–æ 100 –ú–∞–Ω–∏!`;
                        MESSAGE.style.color = '#00FF00';
                    }
                }
            }

            function logout() {
                localStorage.removeItem(CURRENT_USER_KEY);
                displayAuthState(null);
                MESSAGE.textContent = '–í—ã —É—Å–ø–µ—à–Ω–æ –≤—ã—à–ª–∏ –∏–∑ —Å–∏—Å—Ç–µ–º—ã.';
                MESSAGE.style.color = '#E0E0E0';
            }

            function displayAuthState(username) {
                if (username) {
                    // –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–æ—à–µ–ª
                    AUTH_VIEW.style.display = 'none';
                    LOGOUT_VIEW.style.display = 'block';
                    CURRENT_USER.textContent = `–¢–µ–∫—É—â–∏–π –ì–µ–Ω–∏–π: ${username}`;
                    
                    const money = getMoney(username);
                    MONEY_INFO.textContent = `–¢–≤–æ–π —Ç–µ–∫—É—â–∏–π –±–∞–ª–∞–Ω—Å: ${money} –ú–∞–Ω–∏`;
                    MONEY_INFO.style.color = (money === '–ù–ï–î–ï–ô–°–¢–í–ò–¢–ï–õ–ï–ù (–≤–∑–ª–æ–º)') ? '#FF0000' : '#00FF00';
                    
                } else {
                    // –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –≤–æ—à–µ–ª
                    AUTH_VIEW.style.display = 'block';
                    LOGOUT_VIEW.style.display = 'none';
                    // –£–±–µ–¥–∏–º—Å—è, —á—Ç–æ –º—ã –≤ —Ä–µ–∂–∏–º–µ –≤—Ö–æ–¥–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
                    if (!isLoginMode) {
                        switchMode();
                    }
                }
            }

            // --- –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è ---
            const storedUser = localStorage.getItem(CURRENT_USER_KEY);
            displayAuthState(storedUser);

            AUTH_FORM.addEventListener('submit', handleAuth);
            LOGOUT_BUTTON.addEventListener('click', logout);
            SWITCH_BUTTON.addEventListener('click', switchMode);
        };
    </script>
</body>
</html>
