<!DOCTYPE html>
<html lang="ru">
<head>
    <title>–ë–ª—ç–∫–¥–∂–µ–∫ –ú–ú–ú | –î–µ–Ω–∏—Å –ö–∞–∑–∞–∫–æ–≤, –ì–µ–Ω–∏–π</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        body { 
            font-family: 'Arial', sans-serif; 
            background-color: #0c4314; /* –¢–µ–º–Ω–æ-–∑–µ–ª–µ–Ω—ã–π —Ñ–æ–Ω —Å—Ç–æ–ª–∞ */
            color: #E0E0E0; 
            text-align: center; 
            padding-top: 50px; 
            line-height: 1.6;
        }
        .nav-bar { 
            background-color: #333; 
            padding: 10px 0; 
            margin-bottom: 20px;
        }
        .nav-bar a { 
            color: #fff; 
            padding: 14px 20px; 
            text-decoration: none; 
            font-size: 18px; 
            font-weight: bold;
        }
        .nav-bar a:hover { 
            background-color: #575757; 
        }
        h1 { 
            color: #FFD700; 
            text-shadow: 0 0 10px #FFD700;
        }

        /* --- –ò–ì–†–û–í–û–ô –ò–ù–¢–ï–†–§–ï–ô–° --- */
        .game-area {
            max-width: 800px;
            margin: 20px auto;
            padding: 20px;
            background-color: #0d6d1a;
            border-radius: 15px;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.7);
        }

        /* –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –∏ –ë–∞–ª–∞–Ω—Å */
        .info-panel {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding: 10px;
            background-color: rgba(0, 0, 0, 0.3);
            border-radius: 8px;
        }
        #money-display { 
            font-size: 1.8em; 
            color: #00FF00;
        }
        #bet-display {
            font-size: 1.4em;
            color: #FF0000;
        }

        /* –ö–∞—Ä—Ç—ã */
        .hand {
            min-height: 120px;
            margin-bottom: 20px;
            border: 1px dashed rgba(255, 255, 255, 0.2);
            padding: 10px;
            border-radius: 5px;
        }
        .card {
            display: inline-block;
            width: 70px;
            height: 100px;
            background-color: white;
            color: black;
            border: 1px solid #333;
            border-radius: 8px;
            margin: 0 5px;
            line-height: 100px;
            font-size: 1.5em;
            font-weight: bold;
            text-align: center;
            box-shadow: 2px 2px 5px rgba(0, 0, 0, 0.5);
            transition: transform 0.3s;
        }
        .card-back {
            background-color: #800000; /* –¢–µ–º–Ω–æ-–∫—Ä–∞—Å–Ω—ã–π */
            color: white;
            font-size: 2em;
        }

        /* –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ */
        .controls {
            margin-top: 20px;
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 10px;
        }
        .controls input, .controls button {
            padding: 12px 20px;
            font-size: 1.1em;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            transition: background-color 0.2s;
        }
        #bet-input {
            width: 100px;
            text-align: center;
            background-color: #222;
            color: white;
            border: 2px solid #FFD700;
        }
        #deal-button {
            background-color: #FFD700;
            color: #333;
        }
        #hit-button, #stand-button {
            background-color: #0080FF;
            color: white;
        }
        #deal-button:disabled, #hit-button:disabled, #stand-button:disabled {
            background-color: #555;
            cursor: not-allowed;
        }
        
        #result-message {
            font-size: 2em;
            margin-top: 20px;
            min-height: 30px;
            font-weight: bold;
        }

        /* --- –ú–û–ë–ò–õ–¨–ù–ê–Ø –ê–î–ê–ü–¢–ê–¶–ò–Ø --- */
        @media (max-width: 600px) {
            h1 { font-size: 1.8em; }
            .game-area { padding: 10px; margin: 10px; }
            .info-panel { flex-direction: column; gap: 10px; }
            #money-display, #bet-display { font-size: 1.4em; }
            .card { width: 55px; height: 80px; font-size: 1.2em; line-height: 80px; }
            .controls input, .controls button { padding: 10px 15px; font-size: 1em; }
            .controls { gap: 5px; }
            #result-message { font-size: 1.5em; }
        }
    </style>
</head>
<body>
    <div class="nav-bar">
        <a href="index.html">–ì–ª–∞–≤–Ω–∞—è</a>
        <a href="games.html">–ò–≥—Ä—ã</a>
        <a href="about.html">–ê–≤—Ç–æ—Ä</a>
        <a href="login.html">–í—Ö–æ–¥/–í—ã—Ö–æ–¥</a>
    </div>

    <h1>‚ô†Ô∏è –ë–ª—ç–∫–¥–∂–µ–∫ –æ—Ç –ì–µ–Ω–∏—è –ú–ú–ú (–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –ü—Ä–∞–≤–∏–ª–∞) ‚ô£Ô∏è</h1>

    <div class="game-area">
        <div class="info-panel">
            <div id="money-display">–ë–∞–ª–∞–Ω—Å: 0</div>
            <div>
                <label for="bet-input">–°—Ç–∞–≤–∫–∞:</label>
                <input type="number" id="bet-input" value="10" min="1" step="1">
            </div>
            <div id="bet-display">–¢–µ–∫—É—â–∞—è –°—Ç–∞–≤–∫–∞: 0</div>
        </div>

        <div>
            <h2>–î–∏–ª–µ—Ä (<span id="dealer-score">0</span>)</h2>
            <div id="dealer-hand" class="hand"></div>
        </div>

        <div>
            <h2>–ò–≥—Ä–æ–∫ (<span id="player-score">0</span>)</h2>
            <div id="player-hand" class="hand"></div>
        </div>

        <p id="result-message"></p>

        <div class="controls">
            <button id="deal-button">–°–î–ê–¢–¨</button>
            <button id="hit-button" disabled>–ï–©–ï (HIT)</button>
            <button id="stand-button" disabled>–•–í–ê–¢–ò–¢ (STAND)</button>
        </div>
    </div>

    <script>
        window.onload = function() {
            // --- DOM Elements ---
            const MONEY_DISPLAY = document.getElementById('money-display');
            const BET_INPUT = document.getElementById('bet-input');
            const BET_DISPLAY = document.getElementById('bet-display');
            const DEALER_HAND_DIV = document.getElementById('dealer-hand');
            const PLAYER_HAND_DIV = document.getElementById('player-hand');
            const DEALER_SCORE_SPAN = document.getElementById('dealer-score');
            const PLAYER_SCORE_SPAN = document.getElementById('player-score');
            const RESULT_MESSAGE = document.getElementById('result-message');
            const DEAL_BUTTON = document.getElementById('deal-button');
            const HIT_BUTTON = document.getElementById('hit-button');
            const STAND_BUTTON = document.getElementById('stand-button');

            // --- Game State ---
            let currentBet = 0;
            let deck = [];
            let playerHand = [];
            let dealerHand = [];
            let isGameActive = false;

            // --- –§–£–ù–ö–¶–ò–ò –ë–ê–õ–ê–ù–°–ê –° –ó–ê–©–ò–¢–û–ô ---
            const SECRET_KEY = 952; // –¢–≤–æ–π —Å–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á

            function getMoney() {
                const storedMoney = parseInt(localStorage.getItem('denisKazakovMoney')) || 100;
                const storedChecksum = parseInt(localStorage.getItem('denisKazakovChecksum')) || (storedMoney + SECRET_KEY);

                if (storedMoney + SECRET_KEY !== storedChecksum) {
                    console.warn("–û–±–Ω–∞—Ä—É–∂–µ–Ω–∞ –ø–æ–ø—ã—Ç–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è –±–∞–ª–∞–Ω—Å–∞. –ë–∞–ª–∞–Ω—Å —Å–±—Ä–æ—à–µ–Ω.");
                    return setMoney(10);
                }
                return storedMoney;
            }

            function setMoney(amount) {
                const safeAmount = Math.max(10, amount);
                const newChecksum = safeAmount + SECRET_KEY;
                
                localStorage.setItem('denisKazakovMoney', safeAmount);
                localStorage.setItem('denisKazakovChecksum', newChecksum);
                
                MONEY_DISPLAY.textContent = `–ë–∞–ª–∞–Ω—Å: ${safeAmount} –ú–∞–Ω–∏`;
                updateControls();
                
                return safeAmount;
            }
            // --- –ö–û–ù–ï–¶ –§–£–ù–ö–¶–ò–ô –ë–ê–õ–ê–ù–°–ê –° –ó–ê–©–ò–¢–û–ô ---

            function updateControls() {
                const money = getMoney();
                const bet = parseInt(BET_INPUT.value) || 0;
                DEAL_BUTTON.disabled = isGameActive || money < bet || bet <= 0;
                HIT_BUTTON.disabled = !isGameActive;
                STAND_BUTTON.disabled = !isGameActive;
            }

            // --- Card Logic ---
            const CARDS = ['2', '3', '4', '5', '6', '7', '8', '9', '10', 'J', 'Q', 'K', 'A'];
            const SUITS = ['‚ô†Ô∏è', '‚ô•Ô∏è', '‚ô¶Ô∏è', '‚ô£Ô∏è'];

            function createDeck() {
                deck = [];
                for (const suit of SUITS) {
                    for (const card of CARDS) {
                        deck.push({ value: card, suit: suit });
                    }
                }
                // –ü–µ—Ä–µ–º–µ—à–∏–≤–∞–Ω–∏–µ (Fisher-Yates)
                for (let i = deck.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [deck[i], deck[j]] = [deck[j], deck[i]];
                }
            }

            function dealCard(hand) {
                if (deck.length === 0) createDeck();
                return hand.push(deck.pop());
            }

            function getHandValue(hand) {
                let value = 0;
                let aces = 0;

                for (const card of hand) {
                    if (card.value === 'A') {
                        aces++;
                        value += 11;
                    } else if (['K', 'Q', 'J'].includes(card.value)) {
                        value += 10;
                    } else {
                        value += parseInt(card.value);
                    }
                }

                while (value > 21 && aces > 0) {
                    value -= 10;
                    aces--;
                }
                return value;
            }

            function drawHand(hand, div, hideFirstCard = false) {
                div.innerHTML = '';
                let content = '';

                for (let i = 0; i < hand.length; i++) {
                    const card = hand[i];
                    const isHidden = hideFirstCard && i === 0;

                    if (isHidden) {
                        content += `<div class="card card-back">?</div>`;
                    } else {
                        const cardText = `${card.value}${card.suit}`;
                        const color = (card.suit === '‚ô•Ô∏è' || card.suit === '‚ô¶Ô∏è') ? 'red' : 'black';
                        content += `<div class="card" style="color: ${color};">${cardText}</div>`;
                    }
                }
                div.innerHTML = content;
            }

            function updateScores(hideDealerScore = false) {
                PLAYER_SCORE_SPAN.textContent = getHandValue(playerHand);
                if (hideDealerScore) {
                    DEALER_SCORE_SPAN.textContent = '?';
                } else {
                    DEALER_SCORE_SPAN.textContent = getHandValue(dealerHand);
                }
            }

            // --- Game Flow ---

            function startGame() {
                currentBet = parseInt(BET_INPUT.value);
                const money = getMoney();

                if (currentBet <= 0 || currentBet > money) {
                    RESULT_MESSAGE.textContent = "–ù–µ–≤–µ—Ä–Ω–∞—è —Å—Ç–∞–≤–∫–∞!";
                    return;
                }

                setMoney(money - currentBet); // –°–Ω–∏–º–∞–µ–º —Å—Ç–∞–≤–∫—É (–∏—Å–ø–æ–ª—å–∑—É–µ–º setMoney)
                BET_DISPLAY.textContent = `–¢–µ–∫—É—â–∞—è –°—Ç–∞–≤–∫–∞: ${currentBet}`;
                RESULT_MESSAGE.textContent = '–î–µ–ª–∞–µ–º —Å—Ç–∞–≤–∫–∏, –≥–æ—Å–ø–æ–¥–∞!';
                
                playerHand = [];
                dealerHand = [];
                createDeck();

                dealCard(playerHand);
                dealCard(dealerHand);
                dealCard(playerHand);
                dealCard(dealerHand);

                isGameActive = true;
                drawHand(dealerHand, DEALER_HAND_DIV, true);
                drawHand(playerHand, PLAYER_HAND_DIV);
                updateScores(true);
                
                if (getHandValue(playerHand) === 21) {
                    endGame(true, true); 
                } else {
                    updateControls();
                }
            }

            function hit() {
                dealCard(playerHand);
                drawHand(playerHand, PLAYER_HAND_DIV);
                updateScores(true);

                if (getHandValue(playerHand) > 21) {
                    endGame(false);
                }
            }

            function stand() {
                isGameActive = false;
                updateControls();
                
                drawHand(dealerHand, DEALER_HAND_DIV);
                updateScores(false);

                let dealerInterval = setInterval(() => {
                    if (getHandValue(dealerHand) < 17) {
                        dealCard(dealerHand);
                        drawHand(dealerHand, DEALER_HAND_DIV);
                        updateScores(false);
                    } else {
                        clearInterval(dealerInterval);
                        checkWinner();
                    }
                }, 1000);
            }

            function checkWinner() {
                const playerScore = getHandValue(playerHand);
                const dealerScore = getHandValue(dealerHand);

                if (dealerScore > 21) {
                    endGame(true);
                } else if (playerScore > dealerScore) {
                    endGame(true);
                } else if (playerScore < dealerScore) {
                    endGame(false);
                } else {
                    endGame(null);
                }
            }

            function endGame(playerWins, isBlackjack = false) {
                isGameActive = false;
                drawHand(dealerHand, DEALER_HAND_DIV);
                updateScores(false);
                
                let winnings = 0;
                let message = '';
                
                if (playerWins === true) {
                    if (isBlackjack) {
                        winnings = currentBet + Math.floor(currentBet * 1.5);
                        message = `‚ô†Ô∏è‚ô£Ô∏è –ë–õ–≠–ö–î–ñ–ï–ö! –¢—ã ‚Äî –ì–µ–Ω–∏–π! –í—ã–∏–≥—Ä—ã—à: +${winnings} –ú–∞–Ω–∏!`;
                    } else {
                        winnings = currentBet * 2;
                        message = `üéâ –ü–û–ë–ï–î–ê! –í—ã–∏–≥—Ä—ã—à: +${winnings} –ú–∞–Ω–∏.`;
                    }
                    setMoney(getMoney() + winnings);
                } else if (playerWins === false) {
                    winnings = 0;
                    message = `üò≠ –ü–†–û–ò–ì–†–´–®. –î–∏–ª–µ—Ä –∑–∞–±–∏—Ä–∞–µ—Ç ${currentBet} –ú–∞–Ω–∏.`;
                } else {
                    winnings = currentBet;
                    setMoney(getMoney() + winnings);
                    message = `ü§ù –ù–ò–ß–¨–Ø (PUSH). –°—Ç–∞–≤–∫–∞ ${winnings} –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∞.`;
                }

                RESULT_MESSAGE.textContent = message;
                BET_DISPLAY.textContent = `–¢–µ–∫—É—â–∞—è –°—Ç–∞–≤–∫–∞: 0`;
                updateControls();
            }

            // --- Event Listeners and Initialization ---
            DEAL_BUTTON.addEventListener('click', startGame);
            HIT_BUTTON.addEventListener('click', hit);
            STAND_BUTTON.addEventListener('click', stand);
            BET_INPUT.addEventListener('input', updateControls);

            setMoney(getMoney()); // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±–∞–ª–∞–Ω—Å–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        };
    </script>
</body>
</html>
